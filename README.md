# TimeSeriesEnergy
Load Generation Drivers in the Brazilian Electricity System -  A Time Series Modeling Approach


drop t

sort month

gen t = _n

tsset t

reg y x1 x2 x3 x4 x5

sum y x1 x2 x3 x4 x5

# Correlation Matrix
pwcorr y x1 x2 x3 x4 x5

# Unit root test

# The series are not stationary. Thus, I will perform the transformations of the variables to the first difference of the logarithm

# Create logarithmic variables
gen log_y = log(y)
gen log_x1 = log(x1)
gen log_x2 = log(x2)
gen log_x3 = log(x3)
gen log_x4 = log(x4)
gen log_x5 = log(x5)

# Calculate the first difference of logarithmic variables
gen dlog_y = D.log_y
gen dlog_x1 = D.log_x1
gen dlog_x2 = D.log_x2
gen dlog_x3 = D.log_x3
gen dlog_x4 = D.log_x4
gen dlog_x5 = D.log_x5

# Unit Root test

# dfuller performs the augmented Dickey–Fuller test that a variable follows a unit-root process.
# The null hypothesis is that the variable contains a unit root, and the alternative is that the variable
# was generated by a stationary process. You may optionally exclude the constant, include a trend term,
# and include lagged values of the difference of the variable in the regression.

# pperron performs the Phillips–Perron (1988) test that a variable has a unit root. The null hypothesis
# is that the variable contains a unit root, and the alternative is that the variable was generated by a
# stationary process. pperron uses Newey–West (1987) standard errors to account for serial correlation,
# whereas the augmented Dickey–Fuller test implemented in dfuller (see [TS] dfuller) uses additional
# lags of the first-differenced variable.

dfuller D.log_y
dfuller D.log_x1
dfuller D.log_x2
dfuller D.log_x3
dfuller D.log_x4
dfuller D.log_x5

dfuller D.log_y, trend
dfuller D.log_x1, trend
dfuller D.log_x2, trend
dfuller D.log_x3, trend
dfuller D.log_x4, trend
dfuller D.log_x5, trend

pperron D.log_y
pperron D.log_x1
pperron D.log_x2
pperron D.log_x3
pperron D.log_x4
pperron D.log_x5

pperron D.log_y, trend
pperron D.log_x1, trend
pperron D.log_x2, trend
pperron D.log_x3, trend
pperron D.log_x4, trend
pperron D.log_x5, trend

# Vector autoregressive (VAR) models
var D.log_y D.log_x1 D.log_x2 D.log_x3 D.log_x4 D.log_x5

# Granger causality Wald tests
vargranger

# Lagrange-Multiplier test
varlmar

# Tests for normality of residuals
varnorm

# Vector error-correction model - For Vec cannot fit model because of collinearity X5
vec D.log_y D.log_x1 D.log_x2 D.log_x3 D.log_x4

# Tests for normality of residuals
vecnorm 

# Impulse Response of VAR
var D.log_y D.log_x1 D.log_x2 D.log_x3 D.log_x4 D.log_x5

irf create myirf, set(myirfs)

irf graph oirf, impulse(D.log_y) response(D.log_y D.log_x1 D.log_x2 D.log_x3 D.log_x4 D.log_x5)

# outreg export
outreg2 using myregSYS.xls, append ctitle(Global Period)

# Correlation Matrix
pwcorr y x1 x2 x3 x4 x5, sig star(.01)
